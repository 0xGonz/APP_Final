# Replit Configuration for APP23 Financial Dashboard
# This configuration runs both the backend (Express API) and frontend (Vite React)

# Main run command - starts both backend and frontend concurrently
run = """
# Start backend server
cd backend && npm install && npm run dev &
BACKEND_PID=$!

# Wait for backend to be ready
echo "Waiting for backend to start..."
sleep 5

# Start frontend server
cd ../frontend && npm install && npm run dev &
FRONTEND_PID=$!

# Wait for both processes
wait $BACKEND_PID $FRONTEND_PID
"""

# Entry point
entrypoint = "backend/src/server.js"

# Hidden files and directories (don't show in file tree)
hidden = [
  ".config",
  "node_modules",
  ".npm",
  ".upm",
  "package-lock.json",
  ".env"
]

# Replit modules configuration
[nix]
channel = "stable-23_11"

# Deployment configuration
[deployment]
run = ["sh", "-c", "cd backend && npm install && npm start"]
deploymentTarget = "cloudrun"

# Language configuration
[languages.javascript]
pattern = "**/*.{js,jsx,mjs,cjs}"
[languages.javascript.languageServer]
start = "typescript-language-server --stdio"

# Environment variables
[env]
NODE_ENV = "production"
PORT = "3001"

# Package management
[packager]
language = "nodejs"
[packager.features]
enabledForHosting = false
packageSearch = true
guessImports = true

# Unit tests
[unitTest]
language = "nodejs"

# Port configuration
[[ports]]
localPort = 3000
externalPort = 80
exposeLocalhost = true

[[ports]]
localPort = 3001
externalPort = 3001
exposeLocalhost = true
